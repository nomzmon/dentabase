<!-- `NAME PAGE, SEARCH BOX-->
<div class="frame-1">
  <div class="name-page"> To Do</div>
  <div class="search-settings-group">
    <form action="/patient_list" method="GET">
      <img class="icon-search" src="/img/icon-search.svg" />
      <input type="text" class="search-box" placeholder="Search for a Patient" />
    </form>
  </div>

</div>
<!--`END -->

<!-- `TITLES -->

<div class="frame-2 todo-frame2">

  <div class="title-divider"></div>

  <div class="title-group">
    <div class="title-element">Appointments</div>

  </div>
  <div class="title-divider-2"></div>
  <div class="indicator-line"></div>

</div>
<!-- `END TITLES-->

<div class="frame-3 todo-file">


  <!-- `NUM APPOINTMENTS , DATE, BUTTONS-->
  <div class="schedule-group">

    <div class="appointment-number-elements">
      <img class="icon-calendar" src="/img/icon-calendar.svg" />
      <div class="appointment-number">{{appointmentCount}}</div>
      <div class="total-appointment-text">Total Appointment</div>
    </div>

    <div class="date-elements">
      <button id="prev-date-btn" style="background: none; border: none; cursor: pointer;">
        <img class="img" src="/img/icon-arrow_drop_left.svg" alt="Prev" />
      </button>
      <div id="date-display" data-page="{{page}}">{{dateDisplay}}</div>
      {{!-- changed sa taas --}}
      <button id="next-date-btn" style="background: none; border: none; cursor: pointer;">
        <img class="img" src="/img/icon-arrow_drop_right.svg" alt="Next" />
      </button>
    </div>

    <div class="buttons-group">
      <div class="button create-appointment-elements">
        <img class="icon icon-add" src="/img/icon-add.svg" />
        <div class="text-buttons create-appointment-text">Create Appointment</div>
      </div>

      <!-- When clicking create appointment button shows popup form-->
      <div id="form-container" data-page-context="b-todo">
        {{> B_Todo_form }}
      </div>


      <div class="button trash-elements" data-action="delete-selected">
        <img class="icon icon-trash" src="/img/icon-trash.svg" />
        <div class="text-buttons text-wrapper" id = Delete>Delete</div>
      </div>
    </div>

  </div>
  <!--`END SCHEDULE GROUP-->  



  <!-- `LIST OF CATEGORY -->

  <table>
    <thead>
      <tr>
        <th>
          <label class="appointment-checkbox">
            <input id="selectAll" type="checkbox" onclick="toggleSelectAll(this)"/>
            <span class="custom-checkbox"></span>
          </label>
        </th>

        <th>

          <div class="category-text">NAME</div>
</div>
</th>

<th>
  <div class="category-text">PHONE</div>
</th>

<th>
  <div class="category-text">EMAIL</div>
</th>

<th>
  <div class="category-text">TIME</div>
</th>

<th>
  <div class="last-treatment-elements">
    <div class="category-text">SERVICE</div>
  </div>
</th>

</tr>
</thead>
<!-- `END LIST OF CATEGORY -->


<!-- `PATIENT LIST-->
<tbody>
  {{#if patients.length}}
  {{#each patients}}
  <tr id = "row-{{id}}">
    <td>
      <label class="appointment-checkbox">
        <input type="checkbox" class="patient-checkbox" onclick="toggleRowHighlight(this)" value="{{id}}" />
        <span class="custom-checkbox"></span>
      </label>
    </td>

    <td>
      <div class="name" {{#if isPatient}} onclick="window.location.href='/patient-information/{{id}}'" style="cursor: pointer;"
        {{/if}}readonly>{{firstName}} {{lastName}}
      </div>
    </td>

    <td>
      <input type="text" class="phone sched-text" value="{{contact}}" readonly/>
    </td>

    <td>
      <input type="text" class="email sched-text" value="{{email}}"readonly></input>
    </td>

    <td>
      <input type="text" class="time sched-text" value="{{formattedTime}}" readonly></input>
    </td>

    <td>
      <div class="treatment sched-text" readonly>{{latestProcedure}}</div>
    </td>
  </tr>
  {{/each}}
  {{else}}
  <tr>
    <td class="no-appointment-text" colspan="6" style="text-align: center;">No appointments found for this day.</td>
  </tr>
  {{/if}}
</tbody>

</table>
<!-- `END PATIENT LIST-->


</div>
</div>
<script src="B_Todo.js"></script>
<script src="O_Filter_form.js"></script>
<script>
    function toggleSelectAll(selectAllCheckbox){
        const cBoxes = document.querySelectorAll(".patient-checkbox")
        cBoxes.forEach(cb => {cb.checked = selectAllCheckbox.checked})
    }

    function toggleRowHighlight(checkbox) {
        const cBoxes = document.querySelectorAll(".patient-checkbox");
        const isAll = document.getElementById("selectAll");

        if (!checkbox.checked) {
            isAll.checked = false;
        } else if ([...cBoxes].every(cb => cb.checked)) {
            isAll.checked = true;
            console.log("he")
        }
    }

</script>